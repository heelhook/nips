NIP-89
======

Recommended Application Handlers
--------------------------------

`draft` `optional` `author:pablof7z`

This NIP describes `kind:31989` and `kind:31990`: a way for unknown event-kinds application-handlers to be discovered.

## Rationale
Nostr's discoverability and transparent event interaction is one of its most interesting/novel mechanics. This NIP seeks to provide the glue for cross-`kind` client interaction.

### Parties involved
There are three actors to this workflow:

* application that handles a specific event kind
    * Publishes `kind:31990`, detailing how apps should redirect to it
* user who recommends an app that handles a specific event kind
    * Publishes `kind:31989`
* user who seeks a recommendation for an app that handles a specific event kind
    * Queries for `kind:31989` and, based on results, queries for `kind:31990`

# Events

## Recommendation event
```json
{
    "kind": 31989,
    "pubkey": <recommender-user-pubkey>,
    "tags": [
        [ "d", <supported-event-kind> ],
        [ "p", <app-pubkey> ]
    ]
}
```

## Handler information
```json
{
    "kind": 31990,
    "pubkey": <application-pubkey>,
    "tags": [
        [ "d", <supported-event-kind> ]
        [ "web", "https://example.com/", "root" ],
        [ "web", "https://..../a/<bech32>", "nevent" ],
        [ "web", "https://..../p/<bech32>", "nprofile" ],
        [ "web", "https://..../e/<bech32>" ],
        [ "ios", ".../<bech32>" ]
    ]
}
```

`bech32` in a URL MUST be replaced by clients with the NIP-19-encoded entity that should be loaded by the application.

Multiple tags might be registered by the app, following NIP-19 nomenclature as the second value of the array.

A special `root` tag MIGHT be included with the main page of the application.

A tag without a second value in the array SHOULD be considered a generic handler for any NIP-19 entity that is not handled by a different tag.

# User flow
A user A who uses a non-`kind:1`-centric nostr app could choose to announce/recommend a certain kind-handler application.

When user B sees an unknown event kind, e.g. in a social-media centric nostr client, the client would allow user B to interact with the unknown-kind event (e.g. tapping on it).

The client MIGHT query for the user's and the user's follows handler.

# Example

## User A recommends a `kind:31337`-handler
User A might be a user of Zapstr, a `kind:31337`-centric client (tracks). Using Zapstr, user A publishes an event recommending Zapstr as a `kind:31337`-handler.

```json
{
    "kind": 31989,
    "tags": [
        [ "d", "31337" ],
        [ "p", "1743058db7078661b94aaf4286429d97ee5257d14a86d6bfa54cb0482b876fb0" ],
    ]
}
```

## User B interacts with a `kind:31337`-handler
User B might see in their timeline an event referring to a `kind:31337` event
(e.g. a `kind:1` tagging a `kind:31337`).

User B's client, not knowing how to handle a `kind:31337` might display the event
using its `alt` tag (as described in NIP-31). When the user clicks on the event,
the application queries for a handler for this `kind`:

`["REQ", <id>, '[{ "kinds": [31989], "#d": [31337], 'authors': [<user>, <users-contact-list>] }]']`

User B, who follows User A, sees that `kind:31989` event and fetches the `p`-tagged profile for handler information.

```json
{
    "kinds": [31990],
    "#d": [31337],
    "authors": ["1743058db7078661b94aaf4286429d97ee5257d14a86d6bfa54cb0482b876fb0"]
}
```

User B's client sees the application's `kind:31990` which includes the information to redirect the user to the relevant URL with the desired entity replaced in the URL.

## Alternative query bypassing `kind:31989`
Alternatively, users might choose to query directly for `kind:31990` for an event kind. Clients SHOULD be careful doing this and use spam-prevention mechanisms to avoid directing users to malicious handlers.